<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ch-M.D - gmail tag</title>
    <meta charset="utf-8" />
    <link href="http://blog.chmd.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ch-M.D Full Atom Feed" />
    <link rel="stylesheet" href="theme/css/rdark.css" />
    <link rel="stylesheet" type="text/css" href="theme/css/main.css" />
</head>

<body id="index" class="home">
    <header id="banner" class="body">
        <h1><a href="http://blog.chmd.fr">Ch-M.D <strong></strong></a></h1>
    </header><!-- /#banner -->
<section id="content">
    <h2>Articles tagged with gmail</h2>

                <header>
                    <h1><a href="self-archiving-emails.html"
                            id="page-title">Self-Archiving Emails</a></h1>
                        <time datetime="2025-08-19T19:00:00+02:00">Tue 19 August 2025</time>
                </header>
                <article>
                    <p>The concept of Inbox Zero has been around since 2007, and we can thank
Merlin Mann for popularizing it. If you have not watched the
<a href="https://www.youtube.com/watch?v=z9UjeTMb3Yk">presentation</a>, I highly recommend doing it, because it is still
relevant in 2025.</p>
<p>For the past 3 years, I have been running an automation which I now
consider essential to keeping my inbox tidy. I call it <em>self-archiving
emails</em>. The concept is simple: if an email has been sitting in my inbox
for long enough (and for me, that's currently 8 months), I will probably
never do anything about it. So it might as well archive itself. In
practice, 8 months is a worst-case scenario, because a lot of the emails I
receive are only interesting for a few days. The expiration date is set on
a case by case situation, using regular email rules.</p>
<h2>Gmail implementation</h2>
<p>I am leveraging labels to implement this strategy. My flow is as follows:
using basic filters, I label every incoming email with one of the
following: <code>archive-1d</code>, <code>archive-3d</code>, <code>archive-7d</code>, <code>archive-1m</code>,
<code>archive-2m</code>, <code>archive-4m</code> or <code>archive-ifread</code>. Every hour, a script
archives every message which sits in my inbox and is older than what the
label indicates.</p>
<p>The script runs as a google apps script:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// find all the archive-xx labels</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">GmailApp</span><span class="p">.</span><span class="nx">getUserLabels</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">label</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">getName</span><span class="p">())</span>
<span class="w">    </span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;archive-&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;archive-xx&quot;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// archive all the expired emails according to their respective labels</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">label</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">labels</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mf">1</span><span class="p">];</span>
<span class="w">    </span><span class="nx">archive</span><span class="p">(</span><span class="s2">&quot;in:inbox label:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">label</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; older_than:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">duration</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// archive anything older than 8m</span>
<span class="w">  </span><span class="nx">archive</span><span class="p">(</span><span class="s2">&quot;in:inbox older_than:8m&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// archive emails which have no value once I have seen them</span>
<span class="w">  </span><span class="nx">archive</span><span class="p">(</span><span class="s2">&quot;in:inbox is:read label:archive-ifread&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">archive</span><span class="p">(</span><span class="nx">search</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;archiving: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">search</span><span class="p">)</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">threads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">GmailApp</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">search</span><span class="p">);</span>

<span class="w">  </span><span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;found &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; threads:&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">threads</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">   </span><span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nx">i</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;. &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">thread</span><span class="p">.</span><span class="nx">getFirstMessageSubject</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">this_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">batch_size</span><span class="p">);</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">this_batch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">threads</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">this_batch_size</span><span class="p">);</span>
<span class="w">    </span><span class="nx">GmailApp</span><span class="p">.</span><span class="nx">moveThreadsToArchive</span><span class="p">(</span><span class="nx">this_batch</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>There are already plenty of google apps scripts tutorials, so I will not
go into the details of deploying this script, but it roughly involves
going to <a href="https://script.google.com">script.google.com</a>, pasting this code into a new project and
setting the function <code>run</code> to trigger every hour. I am sure you will
figure this out.</p>
<h2>Office 365</h2>
<p>My workplace uses office 365, but that did not stop me from implementing
the same logic using MS powerflows. It is, however, massively ugly, so I
will not share it here. If you are interested in how to do it, send me an
email, I may post another article about it if this is a popular request.</p>
<h2>Feedback</h2>
<p>I have been running this automation for more than 3 years already. It
works. I can report that this concept of self-archiving emails has
drastically reduced the size of my inbox, to the point that I could not
imagine living without it. Surprisingly, I am the only person I know who
runs such an automation. I discussed about it with some friends the other
day, and because this generated some interest, I decided to share it here.
If you end up using it as well, feel free to shoot me an email, and if you
promote this approach to others, please credit me 😉</p>
                </article>
                <a href="self-archiving-emails.html#disqus_thread">
                    To the comments
                </a>

    <hr />
    <a href="feeds/all.atom.xml">Atom feed</a></li>

    <footer id="contentinfo" class="body">
        <address id="about" class="vcard body">
        Generated by <a href="http://getpelican.com/">pelican</a>,
        theme <a href="https://github.com/chmduquesne/small">small</a>
        </address><!-- /#about -->
    </footer><!-- /#contentinfo -->
</body>
</html>