<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Ch-M.D</title>
    <meta name="description" content="">
    <meta name="author" content="Tof">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://blog.chmd.fr/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="http://blog.chmd.fr/theme/local.css" rel="stylesheet">
    <link href="http://blog.chmd.fr/theme/pygments.css" rel="stylesheet">
    <link href="http://blog.chmd.fr/theme/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC' rel='stylesheet' type='text/css'>
</head>

<body>
<header class="blog-header">
  <div class="container">
    <div class="row-fluid">
      <div class="span9">
	<a href="http://blog.chmd.fr" class="brand">Ch-M.D</a>
      </div>

      <div class="span3" id="blog-nav">
	<ul class="nav nav-pills pull-right">
	                        	   	    <li >
	      <a href="http://blog.chmd.fr/category/code.html ">code</a>
	   	    <li  class="active" >
	      <a href="http://blog.chmd.fr/category/howto.html ">howto</a>
	   	    <li >
	      <a href="http://blog.chmd.fr/category/misc.html ">misc</a>
	   	</ul>
      </div>
    </div> <!-- End of fluid row-->
  </div>   <!-- End of Container-->
</header>
    
<div class="container">
    <div class="content">
    <div class="row-fluid">

        <div class="span10">
            <div class='article'>
      <div class="row-fluid">
           <div class="content-title span9">
             <h1>Mettre des couleurs un peu partout (gcc, diff, grep...)</h1b>
           </div>
      </div>
    <div class="row-fluid">
      <div class="span2">
	<p>Fri 19 June 2009 </p>

<p style="text-align: left;">
Filed under <a href="http://blog.chmd.fr/category/howto.html">howto</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="http://blog.chmd.fr/tag/colors.html">colors</a> <a href="http://blog.chmd.fr/tag/console.html">console</a> </p>
<p>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="chmduquesne">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
</p>
      </div>
      
      <div class="span8">
	<p>Aujourd'hui, après avoir passé un bout de temps à déchiffrer la
sortie d'une compilation, je me suis mis en quête d'améliorer mon
quotidien et d'y mettre... des couleurs! Pour ce faire, on cherche
un peu ce qui existe déjà, et on tombe sur colorgcc. C'est
disponible sur pas mal de distributions, c'est juste un script perl
à appeler à la place de gcc, et ça rajoute des couleurs. Pour en
profiter, il suffit de glisser dans vos Makefile</p>
<div class="highlight"><pre><span class="n">CXX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">colorgcc</span>
</pre></div>


<p>Avec les autotools, on peut régler ça à l'invocation du script
configure :</p>
<div class="highlight"><pre><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="n">CXX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">colorgcc</span>
</pre></div>


<p>Bon. Pas mal. Maintenant, les diff. Au boulot, je n'ai pas mieux
sous la main qu'un svn comme gestionnaire de version. Quand je me
tape des svn diff, j'aime bien que ça soit un peu lisible. Et si on
se mettait ça en couleurs? En lisant un peu la doc, on voit qu'il
suffit de se faire un script. Mettons diffwrap.sh.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/sh</span>
<span class="c"># Configure your favorite diff program here.</span>
<span class="nv">DIFF</span><span class="o">=</span><span class="s2">&quot;/usr/bin/colordiff&quot;</span>
<span class="c"># Subversion provides the paths we need as the sixth and seventh</span>
<span class="c"># parameters.</span>
<span class="nv">LEFT</span><span class="o">=</span><span class="k">${</span><span class="nv">6</span><span class="k">}</span>
<span class="nv">RIGHT</span><span class="o">=</span><span class="k">${</span><span class="nv">7</span><span class="k">}</span>
<span class="c"># Call the diff command</span>
<span class="nv">$DIFF</span> <span class="nv">$LEFT</span> <span class="nv">$RIGHT</span>
<span class="c"># Return an errorcode of 0 if no differences were detected, 1 if some were.</span>
<span class="c"># Any other errorcode will be treated as fatal.</span>
</pre></div>
</td></tr></table>

<p>J'ai installé colordiff pour faire le boulot. Il suffit après
d'éditer \~/.subversion/config, et d'ajouter, section [helpers]</p>
<div class="highlight"><pre><span class="n">diff</span><span class="o">-</span><span class="n">cmd</span> <span class="o">=</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">diffwrap</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>Bon ok, mais quand je fais make, j'ai toujours beaucoup de sortie
Il n'y aurait pas moyen de se cantonner aux erreurs gcc lorsqu'il y
en a? Aller, on va baisser un peu ça avec un petit peu (le -j3 est
pour multithreader le make : j'ai un dual core, autant en
profiter).</p>
<div class="highlight"><pre><span class="n">alias</span> <span class="n">make</span><span class="o">=</span><span class="err">&#39;</span><span class="n">make</span> <span class="o">-</span><span class="n">j3</span> <span class="o">-</span><span class="n">s</span><span class="err">&#39;</span>
</pre></div>


<p>Bien entendu, en tant qu'adepte de vim, j'utilise aussi beaucoup
:make. Dans le .vimrc, il peut s'avérer utile de glisser alors:</p>
<div class="highlight"><pre><span class="n">autocmd</span> <span class="n">BufNewFile</span><span class="p">,</span><span class="n">BufRead</span><span class="p">,</span><span class="n">BufEnter</span> <span class="o">*</span><span class="p">.</span><span class="n">cpp</span><span class="p">,</span><span class="o">*</span><span class="p">.</span><span class="n">hpp</span> <span class="n">set</span> <span class="n">makeprg</span><span class="o">=</span><span class="n">make</span><span class="err">\</span> <span class="o">-</span><span class="n">j3</span><span class="err">\</span> <span class="o">-</span><span class="n">s</span>
</pre></div>


<p>Au passage, j'espère que vous connaissiez
<a href="http://www.vim.org/scripts/script.php?script_id=1520">omnicppcomplete</a>,
qui va chez moi dans la même section du .vimrc:</p>
<div class="highlight"><pre><span class="n">autocmd</span> <span class="n">BufNewFile</span><span class="p">,</span><span class="n">BufRead</span><span class="p">,</span><span class="n">BufEnter</span> <span class="o">*</span><span class="p">.</span><span class="n">cpp</span><span class="p">,</span><span class="o">*</span><span class="p">.</span><span class="n">hpp</span> <span class="n">set</span> <span class="n">omnifunc</span><span class="o">=</span><span class="n">omni</span><span class="err">#</span><span class="n">cpp</span><span class="err">#</span><span class="n">complete</span><span class="err">#</span><span class="n">Main</span>
</pre></div>


<p>On combine tout ça à quelques alias assez connus, et on vit un peu
mieux dans sa console...</p>
<div class="highlight"><pre><span class="cp"># SOME COLORS</span>
<span class="k">if</span> <span class="p">[</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dircolors</span> <span class="p">];</span> <span class="n">then</span>
    <span class="n">eval</span> <span class="s">&quot;`dircolors -b`&quot;</span>
    <span class="n">alias</span> <span class="n">ls</span><span class="o">=</span><span class="err">&#39;</span><span class="n">ls</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">dir</span><span class="o">=</span><span class="err">&#39;</span><span class="n">dir</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">vdir</span><span class="o">=</span><span class="err">&#39;</span><span class="n">vdir</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">grep</span><span class="o">=</span><span class="err">&#39;</span><span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">fgrep</span><span class="o">=</span><span class="err">&#39;</span><span class="n">fgrep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">egrep</span><span class="o">=</span><span class="err">&#39;</span><span class="n">egrep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">diff</span><span class="o">=</span><span class="err">&#39;</span><span class="n">colordiff</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">less</span><span class="o">=</span><span class="err">&#39;</span><span class="n">less</span> <span class="o">-</span><span class="n">R</span><span class="err">&#39;</span>
<span class="n">fi</span>
</pre></div>


<p>Si vous avez des trucs utiles, n'hésitez pas! Je suis en
particulier à la recherche d'un script vim qui exploiterait un rien
les options 'errorformat' et 'QuickFixCmdPost' afin d'améliorer
encore la lisibilité des compilations dans la fenêtre quickfix.</p>
	<hr />
      </div>
    </div>
    <div class="span10">
      <h3>Comments</h3>
    
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'chmd'; 

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>  
    </div>
        </div>
        
        
    </div>     </div> </div>

<!--footer-->
<div class="container">
  <div class="well" style="background-color: #E9EFF6">
    <div id="blog-footer">
      <div class="row-fluid">
		<div class="social span2" align="center" id="socialist">
	  <ul class="nav nav-list">
	    <li class="nav-header">
	      Social
	    </li>
	    	    <li><a href="https://twitter.com/#!chmduquesne"><i class="icon-twitter" style="color: #1f334b"></i>twitter</a></li>
	    	    <li><a href="http://resume.chmd.fr"><i class="icon-resume" style="color: #1f334b"></i>resume</a></li>
	                
	  </ul>
	</div>
		        	<div class="site-nav span2" align="center">
          <ul class="nav nav-list" id="site-links">
            <li class="nav-header"> 
              Site
            </li>
            <li><a href="http://blog.chmd.fr"><i class="icon-home" style="color: #1f334b">
                </i>Home</a></li>
            <li><a href="http://blog.chmd.fr/archives.html"><i class="icon-list" style="color: #1f334b">
                </i>Archives</a></li>
	    <li><a href="http://blog.chmd.fr/tags.html"><i class="icon-tags" style="color: #1f334b">
                </i>Tags</a></li>
	    
	                <li><a href="http://blog.chmd.fr/" rel="alternate">
                <i class="icon-rss-sign" style="color: #1f334b"></i>
                Atom Feed</a></li>
	  </ul>

        </div>

      </div> <!--end of fluid row-->
    </div> <!--end of blog-footer-->
    <hr />
    <p align="center"><a href="http://blog.chmd.fr">Ch-M.D</a>
      &copy; Tof
    Powered by <a href="github.com/getpelican/pelican">Pelican</a> and
        <a href="https://twitter.github.com/bootstrap">Twitter Bootstrap</a>. 
        Icons by <a href="http://fortawesome.github.com/Font-Awesome">Font Awesome</a> and 
        <a href="http://gregoryloucas.github.com/Font-Awesome-More">Font Awesome More</a></p>

  </div> <!--end of well -->
</div> <!--end of container -->

<!--/footer-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>


<script>var _gaq=[['_setAccount','UA-17659080-3'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>

</body>
</html>