<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet/less" type="text/css" href="http://chmd.fr/blog/theme/css/style.less">
  <script src="http://chmd.fr/blog/theme/js/less-1.3.3.min.js" type="text/javascript"></script>
  <!-- <link rel="stylesheet" type="text/css" href="http://chmd.fr/blog/theme/css/style.css"> -->

  <link rel="stylesheet" type="text/css" href="http://chmd.fr/blog/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width; initial-scale=1.0">
  <meta name="author" content="Tof">
  <meta name="description" content="Posts and writings by Tof">

    <link href="http://chmd.fr/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ch-M.D Full Atom Feed" />
    
  <meta name="keywords" content="colors, console">

  <title>
    Mettre des couleurs un peu partout (gcc, diff, grep...)  </title>

  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17659080-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="http://chmd.fr/blog">
                <img src="http://chmd.fr/blog/theme/images/logo.png" alt="logo">
              </a>
      <h2><a href="http://chmd.fr/blog">Tof</a></h2>
      <p></p>
      <ul>
                                        <li><a href="https://twitter.com/#!chmduquesne" target="_blank">twitter</a></li>
                <li><a href="http://resume.chmd.fr" target="_blank">resume</a></li>
              </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>Posted on Fri 19 June 2009</p>
    </header>

    <article>
  <div id="article_title">
    <h3><a href="http://chmd.fr/blog/mettre-des-couleurs-un-peu-partout-gcc-diff-grep.html">Mettre des couleurs un peu partout (gcc, diff, grep...)</a></h3>
  </div>
  <div id="article_text">
    <p>Aujourd'hui, après avoir passé un bout de temps à déchiffrer la
sortie d'une compilation, je me suis mis en quête d'améliorer mon
quotidien et d'y mettre... des couleurs! Pour ce faire, on cherche
un peu ce qui existe déjà, et on tombe sur colorgcc. C'est
disponible sur pas mal de distributions, c'est juste un script perl
à appeler à la place de gcc, et ça rajoute des couleurs. Pour en
profiter, il suffit de glisser dans vos Makefile</p>
<div class="highlight"><pre><span class="n">CXX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">colorgcc</span>
</pre></div>


<p>Avec les autotools, on peut régler ça à l'invocation du script
configure :</p>
<div class="highlight"><pre><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="n">CXX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">colorgcc</span>
</pre></div>


<p>Bon. Pas mal. Maintenant, les diff. Au boulot, je n'ai pas mieux
sous la main qu'un svn comme gestionnaire de version. Quand je me
tape des svn diff, j'aime bien que ça soit un peu lisible. Et si on
se mettait ça en couleurs? En lisant un peu la doc, on voit qu'il
suffit de se faire un script. Mettons diffwrap.sh.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/sh</span>
<span class="c"># Configure your favorite diff program here.</span>
<span class="nv">DIFF</span><span class="o">=</span><span class="s2">&quot;/usr/bin/colordiff&quot;</span>
<span class="c"># Subversion provides the paths we need as the sixth and seventh</span>
<span class="c"># parameters.</span>
<span class="nv">LEFT</span><span class="o">=</span><span class="k">${</span><span class="nv">6</span><span class="k">}</span>
<span class="nv">RIGHT</span><span class="o">=</span><span class="k">${</span><span class="nv">7</span><span class="k">}</span>
<span class="c"># Call the diff command</span>
<span class="nv">$DIFF</span> <span class="nv">$LEFT</span> <span class="nv">$RIGHT</span>
<span class="c"># Return an errorcode of 0 if no differences were detected, 1 if some were.</span>
<span class="c"># Any other errorcode will be treated as fatal.</span>
</pre></div>
</td></tr></table>

<p>J'ai installé colordiff pour faire le boulot. Il suffit après
d'éditer \~/.subversion/config, et d'ajouter, section [helpers]</p>
<div class="highlight"><pre><span class="n">diff</span><span class="o">-</span><span class="n">cmd</span> <span class="o">=</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">diffwrap</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>Bon ok, mais quand je fais make, j'ai toujours beaucoup de sortie
Il n'y aurait pas moyen de se cantonner aux erreurs gcc lorsqu'il y
en a? Aller, on va baisser un peu ça avec un petit peu (le -j3 est
pour multithreader le make : j'ai un dual core, autant en
profiter).</p>
<div class="highlight"><pre><span class="n">alias</span> <span class="n">make</span><span class="o">=</span><span class="err">&#39;</span><span class="n">make</span> <span class="o">-</span><span class="n">j3</span> <span class="o">-</span><span class="n">s</span><span class="err">&#39;</span>
</pre></div>


<p>Bien entendu, en tant qu'adepte de vim, j'utilise aussi beaucoup
:make. Dans le .vimrc, il peut s'avérer utile de glisser alors:</p>
<div class="highlight"><pre><span class="n">autocmd</span> <span class="n">BufNewFile</span><span class="p">,</span><span class="n">BufRead</span><span class="p">,</span><span class="n">BufEnter</span> <span class="o">*</span><span class="p">.</span><span class="n">cpp</span><span class="p">,</span><span class="o">*</span><span class="p">.</span><span class="n">hpp</span> <span class="n">set</span> <span class="n">makeprg</span><span class="o">=</span><span class="n">make</span><span class="err">\</span> <span class="o">-</span><span class="n">j3</span><span class="err">\</span> <span class="o">-</span><span class="n">s</span>
</pre></div>


<p>Au passage, j'espère que vous connaissiez
<a href="http://www.vim.org/scripts/script.php?script_id=1520">omnicppcomplete</a>,
qui va chez moi dans la même section du .vimrc:</p>
<div class="highlight"><pre><span class="n">autocmd</span> <span class="n">BufNewFile</span><span class="p">,</span><span class="n">BufRead</span><span class="p">,</span><span class="n">BufEnter</span> <span class="o">*</span><span class="p">.</span><span class="n">cpp</span><span class="p">,</span><span class="o">*</span><span class="p">.</span><span class="n">hpp</span> <span class="n">set</span> <span class="n">omnifunc</span><span class="o">=</span><span class="n">omni</span><span class="err">#</span><span class="n">cpp</span><span class="err">#</span><span class="n">complete</span><span class="err">#</span><span class="n">Main</span>
</pre></div>


<p>On combine tout ça à quelques alias assez connus, et on vit un peu
mieux dans sa console...</p>
<div class="highlight"><pre><span class="cp"># SOME COLORS</span>
<span class="k">if</span> <span class="p">[</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dircolors</span> <span class="p">];</span> <span class="n">then</span>
    <span class="n">eval</span> <span class="s">&quot;`dircolors -b`&quot;</span>
    <span class="n">alias</span> <span class="n">ls</span><span class="o">=</span><span class="err">&#39;</span><span class="n">ls</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">dir</span><span class="o">=</span><span class="err">&#39;</span><span class="n">dir</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">vdir</span><span class="o">=</span><span class="err">&#39;</span><span class="n">vdir</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">grep</span><span class="o">=</span><span class="err">&#39;</span><span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">fgrep</span><span class="o">=</span><span class="err">&#39;</span><span class="n">fgrep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">egrep</span><span class="o">=</span><span class="err">&#39;</span><span class="n">egrep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">diff</span><span class="o">=</span><span class="err">&#39;</span><span class="n">colordiff</span><span class="err">&#39;</span>
    <span class="n">alias</span> <span class="n">less</span><span class="o">=</span><span class="err">&#39;</span><span class="n">less</span> <span class="o">-</span><span class="n">R</span><span class="err">&#39;</span>
<span class="n">fi</span>
</pre></div>


<p>Si vous avez des trucs utiles, n'hésitez pas! Je suis en
particulier à la recherche d'un script vim qui exploiterait un rien
les options 'errorformat' et 'QuickFixCmdPost' afin d'améliorer
encore la lisibilité des compilations dans la fenêtre quickfix.</p>
  </div>
  <div id="article_meta">
    <p>Category: <a href="http://chmd.fr/blog/category/howto.html">howto</a></p>
        <p>Tags:
            <a href="http://chmd.fr/blog/tag/colors.html">colors</a>,            <a href="http://chmd.fr/blog/tag/console.html">console</a>          </p>
      </div>
</article>

    <footer>
      <p><a href="http://chmd.fr/blog/" class="button_accent">&larr; Back to Index</a></p>
    </footer>

    <div id="ending_message">
      <p>&copy Giulio Fidente. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. You can fork the theme on <a href="https://github.com/giulivo/pelican-svbhack" target="_blank">github</a>.</p>
    </div>
  </main>
</body>
</html>